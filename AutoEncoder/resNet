import torch
import torch.nn as nn
import torch.utils.data as data
from torchvision import datasets
from torchvision.transforms import ToTensor
import time 
from util import Models as Model
import torch
import numpy as np
import tensorflow as tf
from torchvision import transforms
from PIL import Image as im



# DataLoader
train_set = datasets.CIFAR10(
    root="data",
    train=False,
    download=True,
    transform=ToTensor(),
)

train_loader = data.DataLoader(train_set, batch_size=10000, shuffle=False)


model = torch.hub.load('pytorch/vision:v0.10.0', 'resnet18', pretrained=True)
model.eval()

train_set_data_reworked = np.transpose(train_set.data, (0,3,1,2))

with torch.no_grad():
    for pics, labels in train_loader:

        print("PICS SHAPE: ", pics.shape)
        code = model(pics)
        print("DILDO", code.shape)
        pics = torch.flatten(pics, 1)

        print("Done")
        print(code.shape)